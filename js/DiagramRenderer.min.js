THREE.DiagramRenderer=function(domElement,buffer){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");domElement.appendChild(canvas),canvas.width=domElement.offsetWidth,canvas.height=domElement.offsetHeight,this.mouse={x:null,y:null,update:e=>{var rect=canvas.getBoundingClientRect(),sX=canvas.width/rect.width,sY=canvas.height/rect.height;this.mouse.x=(e.clientX-rect.left)*sX,this.mouse.y=(e.clientY-rect.top)*sY,this.mouse.x-=canvas.width/2,this.mouse.y-=canvas.height/2}};var inBounds=(x,y,bX,bY,bW,bH)=>x>=bX&&x<bX+bW&&y>=bY&&y<bY+bH,diagram;null==buffer?(diagram=new Image).src="model/diagram.jpg":diagram=buffer,this.size=[4,4],this.seats=null,this.getSeatPosition=(index=>{var seat=this.seats[index],sX=this.size[0]/2,sY=this.size[1]/2;return[seat.position[0]*this.size[0]-sX,seat.position[1]*this.size[1]-sY]}),this.getSeatAt=((x,y)=>{for(var index in this.seats){var pos=this.getSeatPosition(index);if(inBounds(x,y,...pos,...this.size))return index}return null}),this.render=(()=>{for(var index in ctx.fillStyle="#ffffff",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.drawImage(diagram,0,0,canvas.width,canvas.height),ctx.save(),ctx.translate(canvas.width/2,canvas.height/2),ctx.fillStyle="#ff0000",ctx.fillRect(-1,-1,2,2),ctx.fillText(this.mouse.x+":"+this.mouse.y,5,2),ctx.fillStyle="#000000",this.seats){var pos=this.getSeatPosition(index);inBounds(this.mouse.x,this.mouse.y,...pos,...this.size)?ctx.fillRect(...pos,...this.size):ctx.strokeRect(...pos,...this.size)}ctx.restore()}),onClick=(e=>{this.mouse.update(e);var seat=this.getSeatAt(this.mouse.x,this.mouse.y);seat&&changeView(seat)}),onMouseMove=(e=>{this.mouse.update(e)}),this.connect=(()=>{domElement.addEventListener("click",onClick),domElement.addEventListener("mousemove",onMouseMove)}),this.disconnect=(()=>{domElement.removeEventListener("click",onClick),domElement.removeEventListener("mousemove",onMouseMove)}),this.dispose=this.disconnect,this.connect()},THREE.DiagramRenderer.prototype.constructor=THREE.DiagramRenderer;